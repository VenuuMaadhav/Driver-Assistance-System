function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 25-Sep-2017 15:16:59.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 64xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.010446585714817;-0.00787531957030296;0.000792150851339102;0.000697260140441358;-0.0318391174077988;-0.0370668731629848;0.0114541621878743;0.00944378133863211;-0.0182708948850632;-0.037408035248518;0.0105685451999307;0.0130186071619391;-0.00599977560341358;-0.00738126924261451;0.0009831105126068;0.000291699485387653;-0.0940855517983437;-0.0372716039419174;0.00533829489722848;0.00647666398435831;-0.149321094155312;-0.169529378414154;0.0968272313475609;0.0544799156486988;-0.128650411963463;-0.147380292415619;0.121345788240433;0.0796935260295868;-0.0316379480063915;-0.0221415590494871;0.00995232537388802;0.00256200297735631;-0.0700392127037048;-0.0450619198381901;0.00300016114488244;0.0029537184163928;-0.159351080656052;-0.118284732103348;0.151935130357742;0.0620976537466049;-0.274603694677353;-0.191733568906784;0.160479366779327;0.0689068138599396;-0.0451015345752239;-0.0362674966454506;0.0138495052233338;0.00536813540384173;-0.0118280993774533;-0.00348584959283471;0.000410447653848678;0.0005653309635818;-0.0157123804092407;-0.0426004752516747;0.00624872837215662;0.00959920976310968;-0.0354754142463207;-0.0415856875479221;0.00836988911032677;0.00621342286467552;-0.00334786460734904;-0.00597104895859957;0.000656237709335983;0.000563158537261188];
x1_step1.gain = [129.769191453526;120.399850977769;198.978198448329;180.032822434088;28.3637084834695;33.1143566871587;37.0961068725643;27.204913567843;33.9519305934093;29.4661201664835;29.0342246689603;36.0972527739164;146.327409441382;140.073692564375;210.036220569688;145.462476925384;13.2219263580318;25.5404865761986;21.7795795146074;30.042353647962;3.82442813758794;6.6586532603644;4.77766078642902;6.31451104447119;4.65452269510096;6.56542578084128;3.92469028721839;5.69680739940457;27.0684901669857;41.5768019697429;27.2704855034202;32.6533275832122;17.6126303935083;27.0642736969905;24.6094793743346;27.8274472618562;3.7108369165459;8.39001070491473;6.18197799930266;4.4360321238678;3.84071516002178;6.11691220409814;5.69338704149261;6.60297334630402;22.7623322644478;36.566514033441;25.9718501218243;34.2545738119947;115.14126375027;251.884842885706;173.716393138702;130.190997740783;37.0399618610536;20.3036850064876;31.4742925620719;35.3592900544731;28.7727267148689;21.0680238939797;30.0407411226871;34.0082530067325;167.575621942929;155.403959513179;198.650041096474;156.788087285487];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.4517741972949312;1.0374096123969365;1.0455868472005041;-0.71697070452715106;0.14749387608976644;-0.10655471524828736;-0.92117905870175631;-0.93928341232332269;1.1765707167216539;-1.854694181258711];
IW1_1 = [-0.18903885445774898 -0.4918142015786966 -0.37225010291482585 0.088514827049422096 0.089223058571684416 0.01001595142974554 -0.20175444434601963 -0.67648384496557012 -0.30715080027998343 -0.16109775872322907 0.063452035384788719 -0.67395921039100548 0.47569586524797181 -0.064843669856990221 0.043525746838197696 0.1602282997542934 0.18186531464438083 -0.59725870521872659 -0.38838890790272801 1.0408149897550489 0.11313696046056168 -0.078286972170238514 -0.29584636054049712 -0.41371425112558347 -0.11272903584680842 -0.21479033837582584 0.35944436847413191 0.012747428303984676 0.48811053077167932 0.24348519317858053 0.25925685712125934 -0.00051955632302103788 0.13254080182704736 -0.11949725496889754 -0.040184237997265351 0.35765444172918753 0.42749554127685485 -0.35814601400985874 -0.3863410975989518 0.12795969317815381 0.12654703538378137 0.057420357399107377 0.73283756984410575 -0.27191840795881528 0.61140170822897832 0.15722081285176007 0.30474060857801494 0.10211590280641798 -0.053220833606345483 0.031410304290231075 0.01643711163029226 0.23935895676695068 0.22313170378058939 -0.18293247992274794 0.57047465015414034 -0.79570950554829079 0.69372074690855001 -0.36200242427388762 0.29340682794593975 0.020515064226761456 -0.10023716612427709 -1.0070315130937479 0.28738341102233456 0.45474669588768901;-0.081286567763159526 -0.42249717279769927 0.56029631694750548 0.040244144790243797 -0.18825503183528983 -0.5589481828026186 0.12336025541385623 0.029760785347510109 -0.16405743335690007 -0.040012720633022691 0.25143273055704851 -0.28400546319886238 0.0021782462110235268 -0.2829839285960844 0.18462960860034236 0.37353555301982266 0.35331729726511185 -0.27927831488534605 0.080101466699089741 0.20618873805942811 0.38992320528823854 -0.035278819294335947 0.0007934374468554356 -0.40001668318260247 -0.077505963182486634 -0.0033025036422426081 0.47989619467545486 0.48156558545688882 0.27594476769643328 0.055107889559306594 0.1440302026639578 0.53443690404709288 -0.48936171907792625 -0.11636624481690289 0.086121216051160132 -0.044190986126000129 0.67032360084599352 -0.0029743490264862865 -0.1989770375732911 -0.37198308233840316 -0.50173035948979494 -0.12121382419601172 -0.16284729589397701 0.16770289203646183 0.42799697584411328 0.14309643281107334 -0.11014099453777909 0.29866664593935982 -0.06149117138839396 0.2812852807889975 0.20320229041743526 -0.18984958398059743 -0.10180286300450551 -0.18189737196132272 0.1498950536231406 -0.2857021595860485 0.02006503463496153 0.12072088897977162 -0.029299511679152068 0.38619564970605513 0.24669063519093076 -0.28479457441612666 0.09635642659845646 0.61002116228138303;0.45531634646620389 -0.10986630591587054 -0.17192055846747314 -0.27040867253606282 -0.77019590511209035 -0.60600967230048342 -0.62154205946857821 0.67063098433509649 0.34897144548068537 0.0085179202701568951 0.17282022411288012 -0.56032895173134434 -0.21379305959692918 0.79245394276483272 0.037258644019627779 -0.052680164756502668 -0.48504433408308223 -0.031501013805403197 -0.16552621151428271 0.78285956716841854 -0.56042057181113947 0.43737870100246568 -0.29068792018441314 0.14605126734956658 -0.45767318418144964 0.67815249294827762 0.41725394356810991 -0.33427758771837462 1.2624401210175007 0.20693386853656873 -0.028195421548768869 -0.43211136073779138 -0.17244249795820193 -0.42923148200735062 -0.50137255690431248 0.73562916653128685 -0.070122228412418469 -0.24597430712889579 -0.16394216472404954 -1.1319514944468934 0.38671862032117987 -0.85762655025568713 -0.8108741737769215 0.53683537794402503 -0.04202214604447492 0.040945732195210638 0.094402039177994529 0.049522830454962634 0.090204672835379696 -0.18407450291722044 -1.0242848413578189 0.036100492297364173 -1.1191776525767387 0.084356372845786315 -0.19596143034330987 -0.67347996730681325 -0.21422622779979958 -0.49634391454466437 -0.28706807060937095 -0.45427807094475592 0.60749484849469737 -0.22440559832327325 0.32782973367862012 0.48651327951728252;-0.065540293490954651 -0.17754023152460752 0.12570016659817135 -0.083838559491016623 0.10606884126826782 -0.25326801505726243 0.029713427747130983 0.37938169020575113 -0.24082279284706049 -0.23302719041929151 0.15670241816250496 0.67376580319660417 -0.26648914997340573 -0.21140075031666505 -0.45575600931922761 -0.25416606383169221 -0.25431845907187017 0.27856727298285705 0.31636180570053324 -0.049546207014269678 0.033945897765651545 0.31259224190065743 0.12378643681805417 0.11456776489798484 -0.2270140705943583 0.34416290913578762 -0.3114529988488422 0.20635644101991321 0.32527363837942874 0.16321441631295031 -0.05517579650771598 0.25273197945501891 0.12239710655649472 0.18628603314722372 0.043653388543694431 -0.30533653425757279 -0.5806710671733406 0.28550283997461318 0.30719076789241528 0.015137027225269205 0.33581197209005409 0.010970775817542716 0.022977406885410667 -0.37720619069896644 -0.37692022166947792 -0.077258097714563087 0.20582113036878202 -0.37304820041541964 -0.37716188820084845 -0.035082425875794493 -0.3008486734111035 0.19175345040359928 0.10197962844867385 0.24788794035648279 -0.25694241958679931 -0.11612887737811198 -0.41498159052995937 0.1031479245286151 0.16025060014386638 -0.25385479855487869 0.28484242007380989 0.25397784022028264 -0.28758216464529346 0.1996081020784119;-0.40826883780434764 -0.023614424194609296 0.30910292794188843 -0.045894527405127263 0.12894693442601404 0.30760023748712689 -0.12539004381818281 -0.2721864876852606 -0.44550152126871084 -0.33830095045441061 0.055532734159965465 -0.75779121970395613 0.19043061880715331 -0.35473327211993411 0.13798168408951383 0.1131368030058974 0.38220508719631968 0.15003487442124588 0.044800726764295251 -0.29956441974106879 0.1232465524813075 -0.19208982606337227 0.095350134309200169 -0.28823417038259913 -0.2015686058237415 0.395572080034791 0.34610261722287572 0.5202306505368266 0.056056515744929036 -0.18930582468729429 -0.031286987065278535 -0.23797663848392825 -0.43105061420768737 0.07988340335647065 -0.10348253767516258 0.29188392225086796 -0.25106541777819008 0.39285017608685086 -0.15054257504192009 0.31396635391395222 -0.31482055017920851 -0.37774299961737168 0.34716335573047896 -0.2339287944998493 0.19304306504876373 -0.0056367815380914945 -0.079122357179269021 -0.20326105666854138 -0.39275262471733424 -0.2735653002451946 0.33862361208186476 0.013946513090057976 0.065197604662629555 -0.14126328888248149 0.20777305468610074 0.36184038957648978 0.65327666394098149 0.10137102153561145 0.18821394050454565 0.032243094907457651 0.69279731503906294 0.50364366735163002 0.025788031845109943 -0.038610938410807143;0.77678426958093238 -0.59055131959718676 -0.25692853656869574 -0.2627298219117834 0.48674607911649836 0.18521072227326202 -0.29153017846404361 -0.011652704458337937 -0.63166478414022942 -0.20706295030971986 0.28416274228958138 -0.15692056035683752 -0.20747467357282598 -0.0070076270845604097 0.17815817654356439 0.43624883284506738 0.25268866372122978 -0.0092643068552529795 -0.67800564729000456 -0.20772745387868435 0.49672962565312373 -0.21095429408891411 -0.3037262269834945 -0.00072823526437729158 0.10802299300698799 0.24181767499453616 0.20511706222034096 0.98392960559382681 -0.78337674528146517 -0.20162295331412289 -0.46998650697380234 0.33446321495455983 -0.082923870395221977 0.36420402789202577 -0.10089166437209698 -0.023944516365748687 0.35515840394176901 0.24000249099471629 -0.36312699278144273 1.1124650887534244 -0.49197115793269697 -0.20178738678472868 -0.097405065804056251 0.1946489054933794 -0.34336478384024993 -0.40559371535548533 -0.16706836696398558 -0.16471520928290967 -0.14866004927474724 -0.47765330086986962 -0.074521095778374846 0.15828148058508595 0.14904598876538747 0.010220564084683359 -0.16036983215115788 0.4229860317290105 0.11350327685748562 0.50454525561853003 -0.13994588789466239 -0.61108527696910353 0.45169137079958555 0.039855213076550489 -0.25655756832796028 -0.26362450442547003;-0.12455129328425169 0.42996999030589206 -0.11457484544367674 0.43902449192680254 -0.18969164076553816 0.056096000618284743 -0.033164273080135837 0.1441741204417275 0.3188165222880639 0.19916797580917139 0.049263457636643027 -0.21259595197509093 0.19686237252486638 0.14486367198668426 -0.053715030063780644 -0.15241707121491263 -0.41435558193632205 0.40748257401531918 -0.092269554999663272 0.17993996536427698 -0.24579244466026912 -0.15589781183782858 0.17543813773639266 0.032775170395306016 0.1518996238797761 0.089262460032934199 -0.20914413349781896 -0.19613772317721928 -0.33465102164596627 -0.17426738237593467 -0.11795435099125853 -0.33077630727803292 0.1582463112674109 -0.51784224184547067 0.1243146088692606 0.25527739019182738 -0.15262871104321979 -0.27609738979362369 -0.1208690921666081 0.40719549508956215 -0.19925959410840272 -0.09198553191110076 -0.30572392248368019 -0.1409663112108904 -0.18490477037894223 0.042021418435962805 0.13900340854370352 0.2206343820783471 -0.074796309439860598 -0.16523949748095954 -0.19606854123000658 0.35424602750477963 0.33930093191255883 -0.14741907522056177 -0.0062830535182227948 0.11963882040150203 0.1961334003439307 0.045864281365445264 -0.1064675641011065 -0.31778513406706221 -0.28901646922172453 0.34462486000580811 -0.19034219994475707 0.31192024930556045;-0.28126586021312772 0.28705956526700588 -0.35026279254142589 -0.32281473180661957 0.24353433728315255 0.27857133400799106 -0.19295043172612128 0.2649428075673248 0.33141867600638858 -0.3392373176930486 0.32653992605799914 0.053043895833035246 -0.27593201330846351 -0.095323246911870024 -0.18342613755223591 -0.31378155591038803 -0.16391927974397777 0.074058132983601449 0.33498744462590924 0.019722765805094203 0.010142038783796783 0.26484061608981785 0.062650574208032703 -0.37423905627565518 -0.93175385980071346 -0.5781902842771387 0.18681377065949015 0.13363312798342963 -0.14255312913543172 0.11579539000731225 0.1069892321970544 -0.44009903223943125 -0.15494635912250987 -0.25745475886771668 0.26473820768667222 0.49855983808192295 0.19596441701097073 0.36837576084111967 0.11791375333732512 -0.70727544284659294 0.40910408681637228 0.74616577316995769 -0.94033487402298233 0.32192235614703207 0.53056128275080938 0.67374076774482172 0.34849510681789719 0.15740339406686249 0.19291571788802878 -0.30662290898924521 0.42728304490420055 -0.10232468862743518 0.43755225368577239 -0.10876486754710829 0.12947206073954684 0.069141629434766483 -0.34206736963936429 -0.078383545016701459 -1.0304236316383468 0.7625439329233189 -0.97071758667828445 -0.2134645529373666 0.41017248323991196 0.40794722779467152;0.82508983023574989 0.13843938511213155 -0.39849409747264025 0.35201101794940926 -0.90859174834200662 -0.31157003018792911 0.27080611502372459 0.36676318665308727 0.29795623003846594 -0.61548323697279805 0.070174780731776812 -0.58107814661127899 -0.40204414583336556 -0.26642939262679277 1.0521131321941126 0.57952653830739453 0.38194262381107924 0.11221706040569876 -0.24998958399818338 0.11624616453385135 -0.13543958938727094 -0.38652261045638103 0.099953211940888714 -0.5053537911711653 0.22031539089508873 0.36698877559971138 0.30143825328290297 0.2964692587163747 0.34745320685063863 0.059775954158908795 -0.68264336277293747 -0.29219718694472507 -0.64281401690099738 0.3188535288809613 -0.15790517223167672 0.21900946173678523 0.17942717065191977 0.56586040745035104 0.028840129494759888 0.18522756980811864 0.140591796919082 -0.19898889614144463 0.34130285188456017 -0.063545839358274153 -0.90387490101549606 -0.15974087713266863 -0.72496808380142874 -0.6632662114411797 -0.12673315336420213 -0.77221902457621405 0.14326373214298965 0.55287413402521279 -0.059934162732798973 0.13125050891708459 0.19183494447472646 0.68029627267962012 0.13544185637402875 0.10262758664770281 -0.12397762845967641 -0.55357332617038635 0.75862095141544728 -0.72882983302747906 -0.16289248148595009 -0.41109227531472214;-0.1956422919806233 -0.018391564648371318 -0.16050623617960372 0.2052421224239159 0.296676699463293 -0.42880111009004601 0.036251169025769074 0.63745682349013399 0.20515281791104181 -0.37463745330133141 -0.19744744619019655 0.36573370489781476 0.16146953844607193 -0.31126515007925648 -0.16534480744051269 0.20639003435393802 -0.032954167522387647 0.12348652373156567 0.15138438326375686 0.36275581826745945 -0.12202599002712054 0.12782697541907512 -0.63987455859317333 0.36345352268587783 0.34753804994504717 0.0051766506392769661 -0.56650940740772415 0.17869645368332293 -0.42441325855259465 -0.014086079019300916 0.24571395851506347 0.42187279639675579 0.27122553899452156 -0.27577603880900803 -0.072070032092599157 0.27286710863934777 -0.17768246572614999 0.15613492591993 -0.31558801611114323 0.19309791271080906 -0.16829109871663966 -0.30104107677811431 0.16488642294996228 0.10329588455768282 0.40617875444238194 0.074143969702412063 0.18316291320233488 0.097242509144110756 0.09175335003023799 0.36899479960233217 -0.22003247214807736 0.12702986765537058 0.556888640817786 0.20707726478664029 -0.41207153981716627 0.13091505263643891 -0.36445397286596382 0.068977275333696159 -0.09223117148857557 0.17538295767624409 0.16247397196549704 0.30028962055371206 -0.63328986244273688 0.27910242079737269];

% Layer 2
b2 = -0.67413598425029697;
LW2_1 = [0.31738135872547674 0.31747712436988107 -0.77416694669433894 -0.43669135995560193 0.050773019911592096 0.6069316415635142 0.16413505975034157 -0.45056704999669073 0.35106449577277199 -0.61813766571646656];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.5;
y1_step1.xoffset = 1;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
